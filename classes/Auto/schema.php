<?php
/*****************************************************************************
 *   Copyright (C) 2006-2009, onPHP's MetaConfiguration Builder.             *
 *   Generated by onPHP-1.1.master at 2014-07-23 08:21:16                    *
 *   This file is autogenerated - do not edit.                               *
 *****************************************************************************/

	$schema = new DBSchema();
	
	$schema->
		addTable(
			DBTable::create('backend_user')->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER)->
					setNull(false),
					'id'
				)->
				setPrimaryKey(true)->
				setAutoincrement(true)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::TIMESTAMPTZ)->setTimezoned(true),
					'created_at'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::TIMESTAMPTZ)->setTimezoned(true),
					'updated_at'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::TIMESTAMPTZ)->setTimezoned(true),
					'deleted_at'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER),
					'display_order'
				)->
				setDefault(0)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BOOLEAN),
					'is_active'
				)->
				setDefault(true)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BOOLEAN),
					'is_visible'
				)->
				setDefault(true)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BOOLEAN),
					'is_deleted'
				)->
				setDefault(false)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setNull(false)->
					setSize(255),
					'email'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setNull(false)->
					setSize(255),
					'login'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setNull(false)->
					setSize(32),
					'password'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(255),
					'last_name'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(255),
					'first_name'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(255),
					'mid_name'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(255),
					'mobile_phone'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(255),
					'work_phone'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(1),
					'gender'
				)->
				setDefault('u')
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(65536),
					'text_short'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(65536),
					'text'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BOOLEAN),
					'is_super_admin'
				)->
				setDefault(false)
			)
		);
	
	$schema->
		addTable(
			DBTable::create('backend_user_role')->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER)->
					setNull(false),
					'id'
				)->
				setPrimaryKey(true)->
				setAutoincrement(true)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::TIMESTAMPTZ)->setTimezoned(true),
					'created_at'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::TIMESTAMPTZ)->setTimezoned(true),
					'updated_at'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::TIMESTAMPTZ)->setTimezoned(true),
					'deleted_at'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER),
					'display_order'
				)->
				setDefault(0)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BOOLEAN),
					'is_active'
				)->
				setDefault(true)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BOOLEAN),
					'is_visible'
				)->
				setDefault(true)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BOOLEAN),
					'is_deleted'
				)->
				setDefault(false)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER),
					'parent_id'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setNull(false)->
					setSize(255),
					'name'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setNull(false)->
					setSize(255),
					'title'
				)->
				setDefault('')
			)->
			addNamedIndex('parent_id', "parent_id")
		);
	
	$schema->
		addTable(
			DBTable::create('backend_access_resource')->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER)->
					setNull(false),
					'id'
				)->
				setPrimaryKey(true)->
				setAutoincrement(true)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::TIMESTAMPTZ)->setTimezoned(true),
					'created_at'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::TIMESTAMPTZ)->setTimezoned(true),
					'updated_at'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::TIMESTAMPTZ)->setTimezoned(true),
					'deleted_at'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER),
					'display_order'
				)->
				setDefault(0)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BOOLEAN),
					'is_active'
				)->
				setDefault(true)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BOOLEAN),
					'is_visible'
				)->
				setDefault(true)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BOOLEAN),
					'is_deleted'
				)->
				setDefault(false)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER),
					'parent_id'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BIGINT)->
					setNull(false),
					'type_id'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setNull(false)->
					setSize(255),
					'name'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setNull(false)->
					setSize(255),
					'title'
				)
			)->
			addNamedIndex('parent_id', "parent_id")->
			addNamedIndex('type_id', "type_id")
		);
	
	$schema->
		addTable(
			DBTable::create('employee')->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER)->
					setNull(false),
					'id'
				)->
				setPrimaryKey(true)->
				setAutoincrement(true)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::TIMESTAMPTZ)->setTimezoned(true),
					'created_at'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::TIMESTAMPTZ)->setTimezoned(true),
					'updated_at'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::TIMESTAMPTZ)->setTimezoned(true),
					'deleted_at'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER),
					'display_order'
				)->
				setDefault(0)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BOOLEAN),
					'is_active'
				)->
				setDefault(true)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BOOLEAN),
					'is_visible'
				)->
				setDefault(true)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::BOOLEAN),
					'is_deleted'
				)->
				setDefault(false)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(2048),
					'text_short'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(2048),
					'text'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(255),
					'email'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setNull(false)->
					setSize(255),
					'first_name'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setNull(false)->
					setSize(255),
					'last_name'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(255),
					'middle_name'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(255),
					'mobile_phone'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(255),
					'work_phone'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(1),
					'gender'
				)->
				setDefault('u')
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::VARCHAR)->
					setSize(255),
					'position'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::DATE),
					'birth_date'
				)
			)->
			addNamedUnique('email', "email")->
			addNamedIndex('full_name', "first_name", "last_name", "middle_name")->
			addNamedIndex('mobile_phone', "mobile_phone")->
			addNamedIndex('birth_date', "birth_date")
		);
	
	$schema->
		addTable(
			DBTable::create('backend_user__backend_user_role')->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER)->
					setNull(false),
					'backend_user_role_id'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER)->
					setNull(false),
					'backend_user_id'
				)
			)->
			addUniques('backend_user_role_id', 'backend_user_id')
		);
	
	// backend_user__backend_user_role.backend_user_role_id -> backend_user_role.id
	$schema->
		getTableByName('backend_user__backend_user_role')->
		getColumnByName('backend_user_role_id')->
		setReference(
			$schema->
				getTableByName('backend_user_role')->
				getColumnByName('id'),
				ForeignChangeAction::cascade(),
				ForeignChangeAction::cascade()
			);
	
	// backend_user__backend_user_role.backend_user_id -> backend_user.id
	$schema->
		getTableByName('backend_user__backend_user_role')->
		getColumnByName('backend_user_id')->
		setReference(
			$schema->
				getTableByName('backend_user')->
				getColumnByName('id'),
				ForeignChangeAction::cascade(),
				ForeignChangeAction::cascade()
			);
	
	// backend_user_role.parent_id -> backend_user_role.id
	$schema->
		getTableByName('backend_user_role')->
		getColumnByName('parent_id')->
		setReference(
			$schema->
				getTableByName('backend_user_role')->
				getColumnByName('id'),
				ForeignChangeAction::restrict(),
				ForeignChangeAction::cascade()
			);
	
	$schema->
		addTable(
			DBTable::create('backend_user_role__backend_access_resource')->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER)->
					setNull(false),
					'backend_access_resource_id'
				)
			)->
			addColumn(
				DBColumn::create(
					DataType::create(DataType::INTEGER)->
					setNull(false),
					'backend_user_role_id'
				)
			)->
			addUniques('backend_access_resource_id', 'backend_user_role_id')
		);
	
	// backend_user_role__backend_access_resource.backend_access_resource_id -> backend_access_resource.id
	$schema->
		getTableByName('backend_user_role__backend_access_resource')->
		getColumnByName('backend_access_resource_id')->
		setReference(
			$schema->
				getTableByName('backend_access_resource')->
				getColumnByName('id'),
				ForeignChangeAction::cascade(),
				ForeignChangeAction::cascade()
			);
	
	// backend_user_role__backend_access_resource.backend_user_role_id -> backend_user_role.id
	$schema->
		getTableByName('backend_user_role__backend_access_resource')->
		getColumnByName('backend_user_role_id')->
		setReference(
			$schema->
				getTableByName('backend_user_role')->
				getColumnByName('id'),
				ForeignChangeAction::cascade(),
				ForeignChangeAction::cascade()
			);
	
	// backend_access_resource.parent_id -> backend_access_resource.id
	$schema->
		getTableByName('backend_access_resource')->
		getColumnByName('parent_id')->
		setReference(
			$schema->
				getTableByName('backend_access_resource')->
				getColumnByName('id'),
				ForeignChangeAction::restrict(),
				ForeignChangeAction::cascade()
			);
	
?>